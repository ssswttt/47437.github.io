<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Permissions-Policy" content="compute-pressure=*">
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome图标 -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
      // 配置Tailwind自定义样式
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#90cdf4', // 调整为更协调的蓝色
            },
          },
        }
      }
    </script>
    
    <style type="text/tailwindcss">
      @layer utilities {
        .content-auto {
          content-visibility: auto;
        }
        .chat-container {
          @apply w-full h-screen; /* 全屏高度，无顶部空白 */
        }
        .back-button {
          @apply fixed top-0 left-0 z-40 bg-primary text-white p-3 rounded-r-full shadow-lg hover:bg-primary/90 transition-all duration-300 flex items-center justify-center;
          /* 调整定位：左上角紧贴，圆角仅右侧，避免遮挡内容 */
        }
      }
    </style>
  </head>
  <body class="m-0 p-0 bg-gray-50">
    <!-- 返回按钮 -->
    <a href="home.html" class="back-button" title="返回首页">
      <i class="fa fa-arrow-left text-xl"></i>
    </a>
    
    <!-- Coze 组件容器 -->
    <div id='app' class="chat-container bg-white"></div>
    
    <!-- 引入官方 builder-web-sdk -->
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/builder-web-sdk/0.1.0/dist/umd/index.js"></script>
    
    <script>
      // 初始化 Coze SDK 的函数
      async function initCozeSDK() {
        try {
          // 调用后端接口获取 SAT
          const response = await fetch('https://mrfxeeearymshwpchrfu.supabase.co/functions/v1/get-coze-sat');
          const { sat } = await response.json();

          // 初始化 SDK
          new CozeWebSDK.AppWebSDK({
            token: sat,
            appId: '7560686566256361523',
            container: '#app',
            userInfo: {
              id: 'user',
              url: 'https://lf-coze-web-cdn.coze.cn/obj/eden-cn/lm-lgvj/ljhwZthlaukjlkulzlp/coze/coze-logo.png',
              nickname: 'User'
            },
            ui: {
              className: ''
            }
          });
        } catch (error) {
          console.error("Coze SDK 初始化失败：", error);
        }
      }

      // 页面加载完成后执行初始化
      window.onload = initCozeSDK;
    </script>
  </body>
</html>